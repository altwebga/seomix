import { createDirectus, rest, authentication } from "@directus/sdk";
import {
  Article,
  Project,
  Service,
  Customer,
  Hero,
  Team,
  PrivacyPolicy,
} from "@/config/types";

export interface Schema {
  articles: Article[];
  projects: Project[];
  services: Service[];
  customers: Customer[];
  hero: Hero;
  team: Team[];
  privacy_policy: PrivacyPolicy;
}

const directusUrl = process.env.ENDPOINT ?? "http://localhost:8055";
const token = process.env.TOKEN ?? "";

const directus = createDirectus<Schema>(directusUrl)
  .with(authentication())
  .with(
    rest({
      onRequest: (options) => ({ ...options, revalidate: 86400 }),
    })
  );

if (token) {
  await directus.setToken(token);
}

export default directus;
